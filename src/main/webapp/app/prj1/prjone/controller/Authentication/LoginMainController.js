Ext.define('Buzzor.prj1.prjone.controller.Authentication.LoginMainController',{extend : 'Ext.app.ViewController',alias : 'controller.LoginMainController',init : function(){this.renderTreeData();},addCommunicationLog : function(response,  success, daoInfo) {try{if (success) {var responseData = Ext.JSON.decode(response.responseText);}if(daoInfo == null){responseObj = {name : '',status : response.status,statusText : response.statusText,success : success,message : success ? responseData.response.message : 'Failed'};}else{responseObj = {name : (daoInfo.fieldLabel != null)? daoInfo.fieldLabel: daoInfo.title,status : response.status,statusText : response.statusText,success : success,message : success ? responseData.response.message : 'Failed'};}this.view.communicationLog.push(responseObj);} catch(addCommunicationLogException){}},renderTreeData :  function(){var formPanel = this.getView().down("#Login");var url = formPanel.restURL;var scope = this;var me = this;Ext.Ajax.request({url : 'secure'+url+'/findAll',method:'GET', sender:scope,jsonData :{},success : function(response,scope){var jsonRespone = Ext.JSON.decode(response.responseText);var data = jsonRespone.response.data;var currentView =  scope.sender.getView();var tree = currentView.down("#LoginTree");var rootNode = tree.getRootNode();rootNode.removeAll();for (var int = 0; int < data.length; int++) {var childNode = { text:data[int].primaryDisplay, bConfig:data[int], leaf : true, icon:'images/table_icon.png' };rootNode.appendChild(childNode);}tree.getStore().sort('text','ASC');LoginMainControllerGrid = me.view.down('#LoginGrid').controller;LoginMainControllerGrid.setData(data);var daoInfo = scope.sender.view.down('#LoginTree');scope.sender.addCommunicationLog(response, true, daoInfo);},failure : function(response, scope){var daoInfo = scope.sender.view.down('#LoginTree');scope.sender.addCommunicationLog(response, false, daoInfo);}},scope);},treeClick : function( me, record, item, index, e, eOpts ){if (record.data.leaf) {var LoginGrid = this.view.down('#LoginGrid');var foundRecord = LoginGrid.store.findRecord('primaryKey',record.data.bConfig.primaryKey);LoginGrid.setSelection(foundRecord);}var formPanel = this.getView().down("#Login");var vm = formPanel.getViewModel();var data = record.data.bConfig;vm.setData(data);CommunicationDataGridGrid = this.view.up().down('#CommunicationDataGrid');CommunicationDataGridStore = CommunicationDataGridGrid.getStore();CommunicationDataGridStore.clearData();CommunicationDataGridRec = record.data.bConfig.coreContactscommunicationData;CommunicationDataGridStore.setRecords(CommunicationDataGridRec);CommunicationDataGridGrid.setSelection(0);PassRecoveryGridGrid = this.view.up().down('#PassRecoveryGrid');PassRecoveryGridStore = PassRecoveryGridGrid.getStore();PassRecoveryGridStore.clearData();PassRecoveryGridRec = record.data.bConfig.userpassRecovery;PassRecoveryGridStore.setRecords(PassRecoveryGridRec);PassRecoveryGridGrid.setSelection(0);AddressGridGrid = this.view.up().down('#AddressGrid');AddressGridStore = AddressGridGrid.getStore();AddressGridStore.clearData();AddressGridRec = record.data.bConfig.coreContactsaddress;AddressGridStore.setRecords(AddressGridRec);AddressGridGrid.setSelection(0);}});